import{j as y}from"./index-VWaDGczM.js";import{g as j,r as w}from"./index-DjeUAv9f.js";import{z as e,K as v,r as b}from"./useAppNameEnum-B_RCZZaG.js";import{c as k,e as C}from"./utils-BGG_ggsw.js";import{g as x,a as A}from"./username-DImii0_h.js";function S(){return k(x,arguments)}const O=S().map(t=>e.literal(t)),U=e.union(O),R=e.enum(["whatsapp"]);/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var T=I;function I(t,o){if(typeof t!="string")throw new TypeError("argument str must be a string");var n={},s=t.length;if(s<2)return n;var p=o&&o.decode||M,r=0,c=0,i=0;do{if(c=t.indexOf("=",r),c===-1)break;if(i=t.indexOf(";",r),i===-1)i=s;else if(c>i){r=t.lastIndexOf(";",c-1)+1;continue}var u=h(t,r,c),a=m(t,c,u),g=t.slice(u,a);if(!n.hasOwnProperty(g)){var l=h(t,c+1,i),d=m(t,i,l);t.charCodeAt(l)===34&&t.charCodeAt(d-1)===34&&(l++,d--);var f=t.slice(l,d);n[g]=P(f,p)}r=i+1}while(r<s);return n}function h(t,o,n){do{var s=t.charCodeAt(o);if(s!==32&&s!==9)return o}while(++o<n);return n}function m(t,o,n){for(;o>n;){var s=t.charCodeAt(--o);if(s!==32&&s!==9)return o+1}return n}function M(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function P(t,o){try{return o(t)}catch{return t}}var E=F;function F(t,o){if(typeof t!="string"||typeof o!="string")return!1;var n=t.length===o.length?0:1;n&&(o=t);for(var s=0,p=t.length;s<p;++s)n|=t.charCodeAt(s)^o.charCodeAt(s);return n===0}const D=j(E);async function V(t,o,n,{intercept:s}={intercept:()=>{}}){const p=new Headers(n==null?void 0:n.headers);p.set("Accept","application/json");const r=await fetch(o,{credentials:"include",...n,headers:p}),c=r.clone(),i=await r.json(),u=s({status:r.status,json:i});if(u)return u;if(!r.ok||typeof i!="object")throw c;const{continue_url:a=null}=i;if(!a)throw Response.json("Missing a continue_url",{status:400,statusText:"Missing a continue_url"});const g=new URL(a),l=new URL(t.url);return g.origin!==l.origin||g.pathname.startsWith("/api/")?v(a):b(a)}async function X(t,o,n,s,p,r,{intercept:c}={intercept:()=>{}}){const i=new Headers(s==null?void 0:s.headers);i.set("Accept","application/json"),i.set("Content-Type","application/json");const u=[];n&&u.push(`auth-session-minimized=${n}`),u.length>0&&i.set("Cookie",u.join("; "));const a=await fetch(`https://auth.openai.com/api/accounts${o}`,{credentials:"include",method:"POST",signal:t.signal,...s,headers:i}),g=a.clone(),l=await a.json();let d=[];C()&&(d=a.headers.getSetCookie());const f=c({status:a.status,json:l});if(f)return{page:f,cookies:d};if(!a.ok||typeof l!="object")throw g;const{page:_=null}=l;if(!_)throw Response.json("Missing a page",{status:400,statusText:"Missing a page"});return{page:_,cookies:d}}const L=t=>C()?t.headers.get("cookie")??"":document.cookie;function $(t,o){return T(t)[o]||null}function Z(t){const{session_id:o}=Y(L(t)),s=new URL(t.url).searchParams.get("session_id");if(!D(s,o))throw Response.json("Your authorization session was not initialized or has expired",{status:400,statusText:"Invalid Session"})}const q=e.object({connection_name:e.string(),title:e.string(),connection_provider:e.number().int().nullish()}),z=e.discriminatedUnion("factor_type",[e.object({id:e.string(),factor_type:e.literal("recovery_code")}),e.object({id:e.string(),factor_type:e.literal("totp")}),e.object({id:e.string(),factor_type:e.literal("email"),metadata:e.object({email:e.string()})})]),H=e.discriminatedUnion("factor_type",[e.object({id:e.string(),factor_type:e.literal("recovery_code"),metadata:e.object({secret:e.string()})}),e.object({id:e.string(),factor_type:e.literal("totp"),metadata:e.object({secret:e.string(),qr_code_secret_url:e.string()})})]),K=e.object({session_id:e.string().optional(),auth_session_logging_id:e.string().optional(),screen_hint:e.string().nullish(),codex_error_state:e.string().optional(),username:A.optional(),username_verified:e.boolean().optional(),email:e.string().optional(),email_verified:e.boolean().optional(),chatgpt_plan_type:e.string().optional(),sso:e.object({connections:e.array(q),must_use_enterprise_sso:e.boolean().default(!1)}).optional(),third_party_login_association:R.optional(),workspaces:e.array(e.object({id:e.string(),name:e.string().nullish(),profile_picture_url:e.string().nullish(),profile_picture_alt_text:e.string().nullish(),kind:e.enum(["personal","organization"])})).optional(),openai_client_id:e.string().optional(),app_name_enum:e.string().optional(),promo:e.string().optional(),signup_source:e.string().optional(),persona_inquiry:e.object({id:e.string()}).optional(),mfa_factors:e.array(z).optional(),mfa_enrollment_factors:e.array(H).optional(),login_start_url:e.string().optional(),country_code_hint:U.optional().catch(void 0),original_screen_hint:e.string().optional()}),N="oai-client-auth-session";function Y(t){const o=$(t,N);if(!o)return{is_missing_session:!0};const n=y(o,{header:!0}),s=K.safeParse(n);return s.success?{...s.data,is_missing_session:!1}:{is_missing_session:!0}}const ee=w.createContext(null);export{ee as C,q as S,L as a,K as b,N as c,Z as e,Y as g,X as n,V as r};
//# sourceMappingURL=client-auth-session-dSv1Q7Dl.js.map
