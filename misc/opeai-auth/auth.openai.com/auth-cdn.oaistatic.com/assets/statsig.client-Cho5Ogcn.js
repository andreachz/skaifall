import{M as S,W as T}from"./useAppNameEnum-B_RCZZaG.js";import{D as b}from"./datadog.client-CkkgoxcC.js";import{D as y}from"./device-id.client-B6ZQLaK9.js";import{g as M,h as j}from"./utils-BGG_ggsw.js";import{b as k}from"./_baseGetTag-DBIYhhxi.js";import{o as F}from"./_overArg-BLH_OBOE.js";import{i as H}from"./isObjectLike-nLWjQ9zq.js";var P={},v={},E={};Object.defineProperty(E,"__esModule",{value:!0});E.AutoCaptureEventName=void 0;E.AutoCaptureEventName={PAGE_VIEW:"auto_capture::page_view",PAGE_VIEW_END:"auto_capture::page_view_end",ERROR:"auto_capture::error",SESSION_START:"auto_capture::session_start",PERFORMANCE:"auto_capture::performance",FORM_SUBMIT:"auto_capture::form_submit",CLICK:"auto_capture::click"};var s={};Object.defineProperty(s,"__esModule",{value:!0});s._getSafeNetworkInformation=s._registerEventHandler=s._getSanitizedPageUrl=s._getSafeUrl=s._shouldLogEvent=s._getTargetNode=s._gatherEventData=s._gatherDatasetProperties=void 0;const w=S;function I(n){const t={};if(!n)return t;const e=n==null?void 0:n.dataset;if(!e)return t;for(const i in e)t[`data-${i}`]=e[i]||"";return t}s._gatherDatasetProperties=I;function R(n){var t;const e=n.tagName.toLowerCase(),i={},r=(0,w._getCurrentPageUrlSafe)()||"";i.tagName=e,e==="form"&&(i.action=n.getAttribute("action"),i.method=(t=n.getAttribute("method"))!==null&&t!==void 0?t:"GET",i.formName=n.getAttribute("name"),i.formId=n.getAttribute("id")),["input","select","textarea"].includes(e)&&n.getAttribute("type")!=="password"&&(i.content=n.value,i.inputName=n.getAttribute("name"));const a=O(n);if(a&&(i.href=a.getAttribute("href")),e==="button"||a){i.content=(n.textContent||"").trim();const o=I(a||n);Object.assign(i,o)}return{value:r,metadata:i}}s._gatherEventData=R;function G(n){if(!n)return null;let t=n.target||n.srcElement;return!t||!(t instanceof Element)?null:(t.nodeType===3&&(t=t.parentNode||null),t)}s._getTargetNode=G;function W(n,t){if(!n||!t||t.nodeType!==1)return!1;const e=t.tagName.toLowerCase(),i=n.type.toLowerCase();switch(e){case"html":return!1;case"form":return i==="submit";case"input":case"select":case"textarea":return["change"].includes(i);default:return!!(i==="click"&&(e==="button"||O(t)))}}s._shouldLogEvent=W;function z(){var n,t,e;const i=(e=(t=(n=(0,w._getWindowSafe)())===null||n===void 0?void 0:n.location)===null||t===void 0?void 0:t.href)!==null&&e!==void 0?e:"";let r;try{r=new URL(i)}catch{r=new URL("error:")}return r}s._getSafeUrl=z;function $(){return(0,w._getCurrentPageUrlSafe)()||""}s._getSanitizedPageUrl=$;function q(n,t,e){!n||!n.addEventListener||n.addEventListener(t,e,!0)}s._registerEventHandler=q;function B(){const n=(0,w._getWindowSafe)();if(!n||!n.navigator)return null;const t=n.navigator.connection;return t||null}s._getSafeNetworkInformation=B;function O(n){if(!n)return null;let t=n;for(;t;){const e=t.tagName.toLowerCase();if(["body","document"].includes(e))return null;if(t.tagName.toLowerCase()==="a")return t;t=t.parentElement}return null}var C={};Object.defineProperty(C,"__esModule",{value:!0});C._gatherPageViewPayload=void 0;const N=S;function K(n){var t,e;const i=(0,N._getDocumentSafe)(),r=(0,N._getWindowSafe)();if(!i||!r)return{};const a=r==null?void 0:r.navigator,o=(i==null?void 0:i.referrer)||"";let c=new URL("empty:");if(o)try{c=new URL(o||"empty:")}catch{}const d=J(c),g=Y(n),l={};return n.searchParams.forEach((f,m)=>{l[m]=f}),Object.assign(Object.assign(Object.assign(Object.assign({},d),g),l),{title:(i==null?void 0:i.title)||"",locale:(a==null?void 0:a.language)||"unknown",hostname:n.hostname||"unknown",pathname:n.pathname||"unknown",referrer:o,screen_width:((t=r==null?void 0:r.screen)===null||t===void 0?void 0:t.width)||"unknown",screen_height:((e=r==null?void 0:r.screen)===null||e===void 0?void 0:e.height)||"unknown",viewport_width:(r==null?void 0:r.innerWidth)||"unknown",viewport_height:(r==null?void 0:r.innerHeight)||"unknown"})}C._gatherPageViewPayload=K;function Y(n){const t=n.searchParams,e={};return["utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid","gclsrc","dclid","fbclid","msclkid","mc_eid","mc_cid","twclid","li_fat_id","igshid","utm_id","ttc","ttclid","ttc_id"].forEach(r=>{const a=t.get(r);a&&(e[r]=a)}),e}function x(n){const t=n.hostname;return["google","bing","yahoo","duckduckgo","baidu"].find(i=>t.includes(i+"."))||""}function J(n){const t=x(n),e=n.searchParams.get(t==="yahoo"?"p":"q")||"";return{searchEngine:t,searchQuery:e}}Object.defineProperty(v,"__esModule",{value:!0});v.AutoCapture=v.runStatsigAutoCapture=v.StatsigAutoCapturePlugin=void 0;const _=S,h=E,u=s,Q=C,X=6e5,Z={submit:h.AutoCaptureEventName.FORM_SUBMIT,click:h.AutoCaptureEventName.CLICK};class tt{constructor(t){this._options=t,this.__plugin="auto-capture"}bind(t){L(t,this._options)}}v.StatsigAutoCapturePlugin=tt;function L(n,t){return new U(n,t)}v.runStatsigAutoCapture=L;class U{constructor(t,e){var i,r,a;this._client=t,this._startTime=Date.now(),this._deepestScroll=0,this._disabledEvents={},this._previousLoggedPageViewUrl=null,this._hasLoggedPageViewEnd=!1,this._inactiveTimer=null;const{sdkKey:o,errorBoundary:c,values:d}=t.getContext();this._disabledEvents=(r=(i=d==null?void 0:d.auto_capture_settings)===null||i===void 0?void 0:i.disabled_events)!==null&&r!==void 0?r:{},this._errorBoundary=c,this._errorBoundary.wrap(this),this._client.$on("values_updated",()=>{var l,f;const m=this._client.getContext().values;this._disabledEvents=(f=(l=m==null?void 0:m.auto_capture_settings)===null||l===void 0?void 0:l.disabled_events)!==null&&f!==void 0?f:this._disabledEvents}),this._eventFilterFunc=e==null?void 0:e.eventFilterFunc;const g=(0,_._getDocumentSafe)();if(!(0,_._isServerEnv)()){__STATSIG__=(0,_._getStatsigGlobal)();const l=(a=__STATSIG__.acInstances)!==null&&a!==void 0?a:{};l[o]=this,__STATSIG__.acInstances=l}if((g==null?void 0:g.readyState)==="loading"){g.addEventListener("DOMContentLoaded",()=>this._initialize());return}this._initialize()}_addEventHandlers(){const t=(0,_._getWindowSafe)(),e=(0,_._getDocumentSafe)();if(!t||!e)return;const i=(r,a=!0)=>{this._autoLogEvent(r||t.event),a&&this._bumpInactiveTimer()};(0,u._registerEventHandler)(e,"click",r=>i(r)),(0,u._registerEventHandler)(e,"submit",r=>i(r)),(0,u._registerEventHandler)(t,"error",r=>i(r,!1)),(0,u._registerEventHandler)(t,"pagehide",()=>this._tryLogPageViewEnd()),(0,u._registerEventHandler)(t,"beforeunload",()=>this._tryLogPageViewEnd()),(0,u._registerEventHandler)(t,"scroll",()=>this._scrollEventHandler())}_addPageViewTracking(){const t=(0,_._getWindowSafe)(),e=(0,_._getDocumentSafe)();!t||!e||((0,u._registerEventHandler)(t,"popstate",()=>this._tryLogPageView()),window.history.pushState=new Proxy(window.history.pushState,{apply:(i,r,[a,o,c])=>{i.apply(r,[a,o,c]),this._tryLogPageView()}}),this._tryLogPageView())}_autoLogEvent(t){var e;const i=(e=t.type)===null||e===void 0?void 0:e.toLowerCase();if(i==="error"&&t instanceof ErrorEvent){this._logError(t);return}const r=(0,u._getTargetNode)(t);if(!r||!(0,u._shouldLogEvent)(t,r))return;const a=Z[i];if(!a)return;const{value:o,metadata:c}=(0,u._gatherEventData)(r);this._enqueueAutoCapture(a,o,c)}_bumpInactiveTimer(){const t=(0,_._getWindowSafe)();t&&(this._inactiveTimer&&clearTimeout(this._inactiveTimer),this._inactiveTimer=t.setTimeout(()=>{this._tryLogPageViewEnd(!0)},X))}_initialize(){this._addEventHandlers(),this._addPageViewTracking(),this._logSessionStart(),this._logPerformance()}_logError(t){const e=(t==null?void 0:t.error)||{};let i=e;if(typeof e=="object")try{i=JSON.stringify(e)}catch{i=typeof(e==null?void 0:e.toString)=="function"?e.toString():"Unknown Error"}this._enqueueAutoCapture(h.AutoCaptureEventName.ERROR,t.message,{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,error_str:i})}_logSessionStart(){const t=this._getSessionFromClient();try{if(!this._isNewSession(t))return;this._enqueueAutoCapture(h.AutoCaptureEventName.SESSION_START,(0,u._getSanitizedPageUrl)(),{sessionID:t.data.sessionID},{flushImmediately:!0})}catch(e){this._errorBoundary.logError("AC::logSession",e)}}_tryLogPageView(){const t=(0,u._getSafeUrl)(),e=this._previousLoggedPageViewUrl;if(e&&t.href===e.href)return;this._previousLoggedPageViewUrl=t,this._hasLoggedPageViewEnd=!1;const i=(0,Q._gatherPageViewPayload)(t);this._enqueueAutoCapture(h.AutoCaptureEventName.PAGE_VIEW,(0,u._getSanitizedPageUrl)(),i,{flushImmediately:!0,addNewSessionMetadata:!0}),this._bumpInactiveTimer()}_tryLogPageViewEnd(t=!1){this._hasLoggedPageViewEnd||(this._hasLoggedPageViewEnd=!0,this._enqueueAutoCapture(h.AutoCaptureEventName.PAGE_VIEW_END,(0,u._getSanitizedPageUrl)(),{scrollDepth:this._deepestScroll,pageViewLength:Date.now()-this._startTime,dueToInactivity:t},{flushImmediately:!0}))}_logPerformance(){const t=(0,_._getWindowSafe)();typeof(t==null?void 0:t.performance)>"u"||typeof t.performance.getEntriesByType!="function"||typeof t.performance.getEntriesByName!="function"||setTimeout(()=>{const e={},i=t.performance.getEntriesByType("navigation");if(i&&i.length>0&&i[0]instanceof PerformanceNavigationTiming){const o=i[0];e.load_time_ms=o.duration,e.dom_interactive_time_ms=o.domInteractive-o.startTime,e.redirect_count=o.redirectCount,e.transfer_bytes=o.transferSize}const r=t.performance.getEntriesByName("first-contentful-paint");r&&r.length>0&&r[0]instanceof PerformancePaintTiming&&(e.first_contentful_paint_time_ms=r[0].startTime);const a=(0,u._getSafeNetworkInformation)();a&&(e.effective_connection_type=a.effectiveType,e.rtt_ms=a.rtt,e.downlink_kbps=a.downlink,e.save_data=a.saveData),this._enqueueAutoCapture(h.AutoCaptureEventName.PERFORMANCE,(0,u._getSanitizedPageUrl)(),e)},1)}_enqueueAutoCapture(t,e,i,r){var a,o,c;const d=t.slice(14);if(this._disabledEvents[t]||this._disabledEvents[d])return;const g=this._getSessionFromClient();try{const l=Object.assign({sessionID:g.data.sessionID,page_url:(c=(o=(a=(0,_._getWindowSafe)())===null||a===void 0?void 0:a.location)===null||o===void 0?void 0:o.href)!==null&&c!==void 0?c:""},i);r!=null&&r.addNewSessionMetadata&&(l.isNewSession=String(this._isNewSession(g)));const f={eventName:t,value:e,metadata:l};if(this._eventFilterFunc&&!this._eventFilterFunc(f))return;this._client.logEvent(f),r!=null&&r.flushImmediately&&this._client.flush().catch(m=>{_.Log.error(m)})}catch(l){this._errorBoundary.logError("AC::enqueue",l)}}_scrollEventHandler(){var t,e,i,r;const a=(e=(t=(0,_._getDocumentSafe)())===null||t===void 0?void 0:t.body.scrollHeight)!==null&&e!==void 0?e:1,o=(0,_._getWindowSafe)(),c=(i=o==null?void 0:o.scrollY)!==null&&i!==void 0?i:1,d=(r=o==null?void 0:o.innerHeight)!==null&&r!==void 0?r:1;this._deepestScroll=Math.max(this._deepestScroll,Math.min(100,Math.round((c+d)/a*100))),this._bumpInactiveTimer()}_isNewSession(t){return Math.abs(t.data.startTime-Date.now())<1e3}_getSessionFromClient(){return this._client.getContext().session}}v.AutoCapture=U;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.StatsigAutoCapturePlugin=n.runStatsigAutoCapture=n.AutoCapture=n.AutoCaptureEventName=void 0;const t=S,e=v;Object.defineProperty(n,"AutoCapture",{enumerable:!0,get:function(){return e.AutoCapture}}),Object.defineProperty(n,"StatsigAutoCapturePlugin",{enumerable:!0,get:function(){return e.StatsigAutoCapturePlugin}}),Object.defineProperty(n,"runStatsigAutoCapture",{enumerable:!0,get:function(){return e.runStatsigAutoCapture}});var i=E;Object.defineProperty(n,"AutoCaptureEventName",{enumerable:!0,get:function(){return i.AutoCaptureEventName}});const r=Object.assign((0,t._getStatsigGlobal)(),{AutoCapture:e.AutoCapture,runStatsigAutoCapture:e.runStatsigAutoCapture,StatsigAutoCapturePlugin:e.StatsigAutoCapturePlugin});n.default=r})(P);var et=F(Object.getPrototypeOf,Object),nt="[object Object]",it=Function.prototype,rt=Object.prototype,D=it.toString,at=rt.hasOwnProperty,ot=D.call(Object);function st(n){if(!H(n)||k(n)!=nt)return!1;var t=et(n);if(t===null)return!0;var e=at.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&D.call(e)==ot}const V="client-tN5GMyzpIPKXd3KNv7ANIfiqjRSvNNTTWbZdbdabF58",ut="WebAnonymousCookieID",ct="DeviceId",lt="AuthSessionLoggingId";function _t(){return M()?"development":j()?"staging":"production"}const p=()=>T.StatsigClient.instance(V);async function Et({clientId:n,appNameEnum:t,auth0ClientId:e,sessionLoggingId:i,signup_source:r}){new T.StatsigClient(V,{locale:navigator.language,appVersion:"e876e17e535a4d63c31f6ff63f30d71d6afe902f-with_cdn",customIDs:{[ut]:y,[ct]:y,stableID:y,[lt]:i},custom:{client_id:n,app_name_enum:t,auth0_client_id:e,signup_source:r}},{environment:{tier:_t()},plugins:[new P.StatsigAutoCapturePlugin({eventFilterFunc:a=>a.eventName===P.AutoCaptureEventName.PERFORMANCE})]}),p().on("gate_evaluation",({gate:a})=>{A("gate",a.name,a.value)}),p().on("experiment_evaluation",({experiment:a})=>{A("experiment",a.name,a.value)}),p().on("layer_evaluation",({layer:a})=>{a.__value&&A("layer",a.name,a.__value)}),await p().initializeAsync()}function St(n){p().logEvent(n.eventName,n.value,n.metadata)}function A(n,t,e){if(e&&st(e))for(const[i,r]of Object.entries(e))b.addFeatureFlagEvaluation(`${n}__${t}__${i}`,r);else b.addFeatureFlagEvaluation(`${n}__${t}`,e)}export{p as g,Et as i,St as l};
//# sourceMappingURL=statsig.client-Cho5Ogcn.js.map
