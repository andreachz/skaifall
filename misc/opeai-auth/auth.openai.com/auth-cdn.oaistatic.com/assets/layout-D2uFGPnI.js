import{M as A,s as w,z as f,w as E,d as T,O as P,c as M,i as D}from"./useAppNameEnum-B_RCZZaG.js";import{c as l,j as d,u as I,r as R}from"./index-DjeUAv9f.js";import{u as B,F as G}from"./FallbackErrorPage-Cfxsq8Fs.js";import{u as J}from"./errorViewDetection-B-3NXqlM.js";import{g as N,a as k,C as K}from"./client-auth-session-dSv1Q7Dl.js";import{g as S}from"./statsig.client-Cho5Ogcn.js";import{u as b}from"./use-event-loggers-BYzAYOjx.js";import{A as F}from"./AuthStepLayout-DRZ_4X3y.js";import{B as p}from"./Button-CCHVtoRV.js";import{F as $}from"./FieldGrouping-BFjljUyA.js";import{L as z}from"./Logo-CFlQEucm.js";import{M as y}from"./index-npON1Cka.js";import"./GeneralError-i619PQZ-.js";import"./noop-DX6rZLP_.js";import"./memoize-BmplEB2s.js";import"./_MapCache-TO9IM_u8.js";import"./_baseGetTag-DBIYhhxi.js";import"./index-VWaDGczM.js";import"./utils-BGG_ggsw.js";import"./username-DImii0_h.js";import"./datadog.client-CkkgoxcC.js";import"./preload-helper-BPn92lI4.js";import"./device-id.client-B6ZQLaK9.js";import"./_overArg-BLH_OBOE.js";import"./isObjectLike-nLWjQ9zq.js";import"./openai-logo-Cr44hqyW.js";var j={},v={},U=l&&l.__awaiter||function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function c(_){try{h(r.next(_))}catch(u){a(u)}}function L(_){try{h(r.throw(_))}catch(u){a(u)}}function h(_){_.done?n(_.value):s(_.value).then(c,L)}h((r=r.apply(i,e||[])).next())})};Object.defineProperty(v,"__esModule",{value:!0});v.LocalOverrideAdapter=void 0;const o=A,m="LocalOverride:Recognized";function O(){return{gate:{},dynamicConfig:{},experiment:{},layer:{}}}function V(i,e){return{gate:Object.assign({},i.gate,e.gate),dynamicConfig:Object.assign({},i.dynamicConfig,e.dynamicConfig),experiment:Object.assign({},i.experiment,e.experiment),layer:Object.assign({},i.layer,e.layer)}}class q{constructor(e){this._overrides=O(),this._sdkKey=e??null}_getLocalOverridesStorageKey(e){return`statsig.local-overrides.${(0,o._getStorageKey)(e)}`}loadFromStorage(){return U(this,void 0,void 0,function*(){if(this._sdkKey==null)return;o.Storage.isReady()||(yield o.Storage.isReadyResolver());const e=this._getLocalOverridesStorageKey(this._sdkKey),t=o.Storage.getItem(e),r=t?(0,o._typedJsonParse)(t,"gate","LocalOverrideAdapter overrides"):null,s=this._hasInMemoryOverrides();r&&(this._overrides=s?V(r,this._overrides):r),s&&this._saveOverridesToStorage()})}_saveOverridesToStorage(){if(this._sdkKey==null||!o.Storage.isReady())return;const e=this._getLocalOverridesStorageKey(this._sdkKey);o.Storage.setItem(e,JSON.stringify(this._overrides))}overrideGate(e,t){this._overrides.gate[e]=t,this._overrides.gate[(0,o._DJB2)(e)]=t,this._saveOverridesToStorage()}_warnIfStorageNotReady(){o.Storage.isReady()||o.Log.warn("Storage is not ready. Override removal may not persist.")}removeGateOverride(e){this._warnIfStorageNotReady(),delete this._overrides.gate[e],delete this._overrides.gate[(0,o._DJB2)(e)],this._saveOverridesToStorage()}getGateOverride(e,t){var r;const s=(r=this._overrides.gate[e.name])!==null&&r!==void 0?r:this._overrides.gate[(0,o._DJB2)(e.name)];return s==null?null:Object.assign(Object.assign({},e),{value:s,details:Object.assign(Object.assign({},e.details),{reason:m})})}overrideDynamicConfig(e,t){this._overrides.dynamicConfig[e]=t,this._overrides.dynamicConfig[(0,o._DJB2)(e)]=t,this._saveOverridesToStorage()}removeDynamicConfigOverride(e){this._warnIfStorageNotReady(),delete this._overrides.dynamicConfig[e],delete this._overrides.dynamicConfig[(0,o._DJB2)(e)],this._saveOverridesToStorage()}getDynamicConfigOverride(e,t){return this._getConfigOverride(e,this._overrides.dynamicConfig)}overrideExperiment(e,t){this._overrides.experiment[e]=t,this._overrides.experiment[(0,o._DJB2)(e)]=t,this._saveOverridesToStorage()}removeExperimentOverride(e){this._warnIfStorageNotReady(),delete this._overrides.experiment[e],delete this._overrides.experiment[(0,o._DJB2)(e)],this._saveOverridesToStorage()}getExperimentOverride(e,t){return this._getConfigOverride(e,this._overrides.experiment)}overrideLayer(e,t){this._overrides.layer[e]=t,this._overrides.layer[(0,o._DJB2)(e)]=t,this._saveOverridesToStorage()}removeLayerOverride(e){this._warnIfStorageNotReady(),delete this._overrides.layer[e],delete this._overrides.layer[(0,o._DJB2)(e)],this._saveOverridesToStorage()}getAllOverrides(){return JSON.parse(JSON.stringify(this._overrides))}removeAllOverrides(){this._warnIfStorageNotReady(),this._overrides=O(),this._saveOverridesToStorage()}getLayerOverride(e,t){var r;const s=(r=this._overrides.layer[e.name])!==null&&r!==void 0?r:this._overrides.layer[(0,o._DJB2)(e.name)];return s==null?null:Object.assign(Object.assign({},e),{__value:s,get:(0,o._makeTypedGet)(e.name,s),details:Object.assign(Object.assign({},e.details),{reason:m})})}_getConfigOverride(e,t){var r;const s=(r=t[e.name])!==null&&r!==void 0?r:t[(0,o._DJB2)(e.name)];return s==null?null:Object.assign(Object.assign({},e),{value:s,get:(0,o._makeTypedGet)(e.name,s),details:Object.assign(Object.assign({},e.details),{reason:m})})}_hasInMemoryOverrides(){return Object.keys(this._overrides.gate).length>0||Object.keys(this._overrides.dynamicConfig).length>0||Object.keys(this._overrides.experiment).length>0||Object.keys(this._overrides.layer).length>0}}v.LocalOverrideAdapter=q;(function(i){var e=l&&l.__createBinding||(Object.create?function(r,s,n,a){a===void 0&&(a=n);var c=Object.getOwnPropertyDescriptor(s,n);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[n]}}),Object.defineProperty(r,a,c)}:function(r,s,n,a){a===void 0&&(a=n),r[a]=s[n]}),t=l&&l.__exportStar||function(r,s){for(var n in r)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&e(s,r,n)};Object.defineProperty(i,"__esModule",{value:!0}),t(v,i)})(j);const g=new j.LocalOverrideAdapter;g.overrideGate.bind(g),g.overrideDynamicConfig.bind(g),g.overrideExperiment.bind(g),g.overrideLayer.bind(g);const H="_logo_1apv9_1",Y={logo:H},Q=f.enum(["show_just_chatgpt_login_button","show_chatgpt_login_and_noauth_buttons"]),W=({variant:i})=>{const e=I(),{logMissingSessionErrorPageAction:t}=b();return d.jsx(F,{title:e.formatMessage({id:"clientAuthSessionLayout.missingClientAuthSession.title",defaultMessage:"Session expired",description:"Title of a page showing that a user's login session has expired and needs to be restarted"}),subTitle:e.formatMessage({id:"clientAuthSessionLayout.missingClientAuthSession.subTitle",defaultMessage:"Your login session has expired, please restart",description:"Subtitle of a page showing that a user's login session has expired and needs to be restarted"}),decoration:d.jsx(z,{name:"openAI",size:48,className:Y.logo}),children:d.jsxs($,{children:[d.jsx(p,{variant:"primary",as:"a",href:"https://chatgpt.com/auth/login_with","data-dd-action-name":"(Missing Session) Log in to ChatGPT",onClick:()=>t({action:"click_chatgpt_login_button"}),children:d.jsx(y,{id:"clientAuthSessionLayout.missingClientAuthSession.restartLogin",defaultMessage:"Log in to ChatGPT",description:"Button to log in to ChatGPT"})},"restart-login"),i==="show_chatgpt_login_and_noauth_buttons"&&d.jsx(p,{variant:"outline",as:"a",href:"https://chatgpt.com","data-dd-action-name":"(Missing Session) Use ChatGPT without an account",onClick:()=>t({action:"click_chatgpt_noauth_button"}),children:d.jsx(y,{id:"clientAuthSessionLayout.missingClientAuthSession.chatNoAuth",defaultMessage:"Use ChatGPT without an account",description:"Link to use ChatGPT without an account"})})]})})},C="missing_client_auth_session",X=f.object({code:f.literal(C),errorPageVariant:Q});function Le({request:i}){const e=N(k(i));if(e.is_missing_session){const t=S().getLayer("auth_unify_login_signup_layer").get("expired_session_error_page_variant","none");if(t!=="none")throw T({code:C,errorPageVariant:t},400)}return{session:e}}const Ae=E(function({loaderData:e}){const t=!e.session.is_missing_session;return x({hasSession:t}),d.jsx(K,{value:e.session,children:d.jsx(P,{})})}),we=M(function({error:e}){J();const t=Z(e);return x({hasSession:t.hasSession}),t.hasSession?d.jsx(G,{}):d.jsx(W,{variant:t.errorPageVariant})});function x({hasSession:i}){const{logMissingSessionDetected:e}=b(),t=B();R.useEffect(()=>{i||e({routeId:t==null?void 0:t.id})},[e,t==null?void 0:t.id,i])}function Z(i){if(!D(i))return{hasSession:!0};const e=X.safeParse(i.data);return e.success?{hasSession:!1,errorPageVariant:e.data.errorPageVariant}:{hasSession:!0}}export{we as ErrorBoundary,Le as clientLoader,Ae as default};
//# sourceMappingURL=layout-D2uFGPnI.js.map
